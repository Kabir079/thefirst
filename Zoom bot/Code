import subprocess
import pyautogui
import time
import csv
import pandas as pd
from datetime import datetime

def sign_in(meetingid):
    subprocess.call(r'C:\Users\Lenovo\AppData\Roaming\Zoom\bin\Zoom')

    time.sleep(2)

    #Clicks the INITIAL-JOIN button
    join_btn = pyautogui.locateCenterOnScreen(r'C:\Users\Lenovo\Desktop\old\photo1.png')
    pyautogui.moveTo(join_btn)
    pyautogui.click()

    # Type the Meeting ID button
    meeting_id_btn = pyautogui.locateCenterOnScreen(r'C:\Users\Lenovo\Desktop\old\photo2.png')
    pyautogui.moveTo(meeting_id_btn)
    pyautogui.write(meetingid)

    # Disabling both the camera and the mic
    media_btn = pyautogui.locateAllOnScreen(r'C:\Users\Lenovo\Desktop\old\photo3.png')
    for a in media_btn:
        pyautogui.moveTo(a)
        pyautogui.click()
        time.sleep(1)

    # Clicking the FINAL-JOIN button
    join_btn = pyautogui.locateCenterOnScreen(r'C:\Users\Lenovo\Desktop\old\photo4.png')
    pyautogui.moveTo(join_btn)
    pyautogui.click()


now = datetime.now().strftime("%H:%M")

def extract(addinglist):
    return [item[0] for item in addinglist]
def newextract(addinglist):
    return [item[1] for item in addinglist]

# Reading the CSV file
with open("timings.csv",newline='') as csvfile:
    rows = csv.reader(csvfile,delimiter=',')
    addinglist = []
    for i in rows:
        addinglist.append(i)

a = extract(addinglist)
b = newextract(addinglist)
print(a)
print(b)

while True :
    now = datetime.now().strftime("%H:%M")
    if a[0] == now :
        sign_in(b[0])
        print("Signed in = 1st meeting ")
        break
    if a[1] == now :
        sign_in(b[1])
        print("Signed in = 2nd meeting ")
        break
    if a[2] == now :
        sign_in(b[2])
        print("Signed in = 3rd meeting ")
        break

